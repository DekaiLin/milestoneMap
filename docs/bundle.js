(function(){var f,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={Ja:!0},ea={};try{ea.__proto__=da;ca=ea.Ja;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var fa=ba,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ia="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ja(a,b){if(b){var c=ia;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}}
ja("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});ja("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});ja("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,h=0;h<e;h++){var l=b[h];if(a.call(c,l,h,b)){a=l;break a}}a=void 0}return a}});window.onload=function(){new g};function n(a){a=Error.call(this,"Assertion failed : "+a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.name="AssertionError"}var q=Error;n.prototype=aa(q.prototype);n.prototype.constructor=n;if(fa)fa(n,q);else for(var r in q)if("prototype"!=r)if(Object.defineProperties){var ka=Object.getOwnPropertyDescriptor(q,r);ka&&Object.defineProperty(n,r,ka)}else n[r]=q[r];n.a=q.prototype;function t(a){if(!a())throw new n(a.toString());};function u(a,b){this.fa=v("span",{});this.J=v("div",{"class":"mMapContainer"});this.J.addEventListener("click",this.Na.bind(this));this.Y=v("span",{"class":"printablePages"});this.l=new la(this.J);this.B=b||ma;this.V=0;this.ca=null;this.W=!1;this.restore(a)}f=u.prototype;
f.restore=function(a){var b=this;t(function(){return Number.isInteger(a.start)});t(function(){return Number.isInteger(a.end)});t(function(){return"string"===typeof a.name});this.start=a.start;this.j=a.end;this.name=a.name;this.G=new na(this);this.v=a.programmes.map(function(a,d){return new oa(a,d,b)});this.i=a.projects.map(function(a,d){return new w(a,d,b)});this.u=a.milestones.map(function(a,d){return new x(a,d,b)});this.b=a.reports.map(function(a,d){return new y(a,d,b)});t(function(){return Number.isInteger(a.currReport)});
t(function(){return b.b[a.currReport]});t(function(){return Number.isInteger(a.cmpReport)});t(function(){return b.b[a.cmpReport]});this.a=this.b[a.currReport];this.g=this.b[a.cmpReport];this.o=a.msAtReports.map(function(a,d){return new pa(a,d,b)});this.C=a.dependencies.map(function(a,d){return new z(a,d,b)})};
function qa(a){return{name:a.name,end:a.j,start:a.start,currReport:a.a.index,cmpReport:a.g.index,reports:a.b.map(function(a){return{date:a.m,name:a.name}}),programmes:a.v.map(function(a){return{name:a.name,comment:a.A}}),projects:a.i.map(function(a){return{name:a.name,programme:a.a.index,comment:a.A}}),milestones:a.u.map(function(a){return{name:a.name,project:a.a.index}}),msAtReports:a.o.map(function(a){return ra(a)}),dependencies:a.C.map(function(a){return sa(a)})}}
function ta(a){var b=a.fa;b.innerHTML="";var c={"class":"reportSelector"},d=a.b.sort(function(a,b){return a.m-b.m}).map(function(a){return a.name+": "+A(a.m)});ua("Snapshot 1 (Current)",a.Ua.bind(a),d,c,b);ua("Snapshot 2 (Baseline)",a.Ta.bind(a),d,c,b)}
f.h=function(){this.J.innerHTML="";this.U=B("svg",{"class":"mMapFixed"},this.J);this.ga=v("div",{"class":"mMapScrollBox"},this.J);this.M=B("svg",{"class":"milestoneMap",height:5E3},this.ga);var a=B("g",{"class":"bg"},this.M);this.ea=B("g",{"class":"dependencies"},this.M);var b=B("g",{"class":"fg"},this.M);this.width=this.M.getBoundingClientRect().width;this.O=new C(this,this.U,a);this.o.forEach(function(a){return a.h()});this.u.forEach(function(a){return a.h()});this.i.forEach(function(a){return a.h()});
this.U.appendChild(this.G.h());a.appendChild(this.G.g);this.v.forEach(function(a){return b.appendChild(a.h())});this.U.appendChild(this.a.I());b.appendChild(this.a.j);D(this)};f.N=5;
function va(a){a.Y.innerHTML="";a.width=a.B.width*u.prototype.N;a.height=a.B.height*u.prototype.N;a.o.forEach(function(a){return a.h()});a.u.forEach(function(a){return a.h()});a.i.forEach(function(a){return a.h()});a.v.forEach(function(a){return a.h()});var b=a.G.h(),c=0,d=0,e=0,h=[];do{var l=B("svg",{"class":"milestoneMapPage",viewbox:"0 0 "+a.B.width*u.prototype.N+" "+a.B.height*u.prototype.N},a.Y);a.O=new C(a,l);var k=a.O.o,m=b.cloneNode(!0);m.setAttribute("transform","translate(0, "+k+")");l.appendChild(m);
k+=a.G.height;m=a.B.height*u.prototype.N-k;if(0>=m)throw Error("Page size not large enough for Business Milestones.");if(c>=a.v.length){l.appendChild(a.a.I().cloneNode(!0));break}var p=B("g",{"class":"dependencies"},l);h.push(p);p=!0;do{var M=a.v[c];M.K=k;var E=wa(M,m,d,p,e);p=!1;l.appendChild(E.c);E.c.setAttribute("transform","translate(0, "+k+")");if(E.index===M.i.length)c++,d=0,k+=m-E.T,m=E.T;else{d=E.index;break}}while(c<a.v.length);k=a.a.I();l.appendChild(k.cloneNode(!0));e++}while(c<a.v.length);
a.C.forEach(function(a){if(a.w===a.g.a&&F(a.b)&&F(a.a)){var b=xa(a.a),c=xa(a.b);c.x-=7;var d=a.b.s.a.B,e=a.a.s.a.B;if(d===e)a=B("g",{"class":"dependency"},h[d]),ya(b,c,a);else{var k=a.g.B.height*u.prototype.N;if(d>e){var l=c.y+k;k=b.y-k}else l=c.y-k,k=b.y+k;e=B("g",{"class":"dependency"},h[e]);d=B("g",{"class":"dependency"},h[d]);za(a,b,{x:c.x,y:l},e);za(a,{x:b.x,y:k},c,d)}}})}function Aa(a){a.C.forEach(function(b){b.h();a.ea.appendChild(b.c)})}f.Na=function(){this.W?this.W=!1:(this.V=0,this.ca=null)};
function D(a){var b=G(a.O.o,[a.G]);a.U.setAttribute("height",b);b=a.qa-b;a.ga.setAttribute("style","max-height:"+b+"px;");b-=4;var c=G(30,a.v);a.M.setAttribute("height",c<b?b:c);a.a.I();Aa(a)}function H(a){a=.2*a.width;return 350>a?a:350}function I(a,b){return(b.valueOf()-a.start)/(a.j-a.start)*(a.width-H(a))+H(a)}function Ba(){var a=new Date(Date.now());return Ca(a.valueOf()-6E4*a.getTimezoneOffset())}function Da(a,b){return b>=a.start&&b<=a.j}
function J(a,b){b=new pa(b,a.o.length,a);a.o.push(b);return b}f.R=function(a){a=new z(a,this.C.length,this);this.C.push(a);this.ea.appendChild(a.c);return a};function Ea(a,b){b=new x(b,a.u.length,a);a.u.push(b);return b}function Fa(a,b){b=new w(b,a.i.length,a);a.i.push(b);return b}function Ga(a,b){b=new oa(b,a.v.length,a);a.v.push(b);return b}
function Ha(a){var b=new y({name:"New Report",date:Ba()},a.b.length,a);a.b.push(b);a.o.filter(function(b){return b.w===a.a}).forEach(function(c){c=ra(c);c.report=b.index;J(a,c)});a.C.filter(function(b){return b.w===a.a}).forEach(function(c){c=sa(c);c.report=b.index;a.R(c)});a.g=a.a;a.a=b}
function Ia(a){for(var b=1;b<a.length;b++){var c=a[b];if(6!==c.length&&5!==c.length)throw Error("CSV row "+(b+1)+" does not contain the correct number of columns");var d=c[4];if("complete"!==d&&"on-track"!==d&&"at-risk"!==d&&"late"!==d&&"previous"!==d)throw Error("Milestone health on row "+(b+1)+" is invalid.Must be one of 'complete', 'on-track', 'at-risk', 'late', or 'previous'");if(isNaN((new Date(c[3]+"T00:00:00.000Z")).valueOf()+1))throw Error("Invalid date format on row "+(b+1)+". The Date must be formatted as YYYY-MM-DD");
}}function Ja(a,b){var c=b[0],d=b[1],e=b[2],h=b[3],l=b[4];b=b[5]||"";if("Business Milestones"!==c){var k=a.v.find(function(a){return a.name===c});k||(k=Ga(a,{name:c}));var m=k.i.find(function(a){return a.name===d});m||(m=Fa(a,{name:d,programme:k.index}))}else m=a.G;(k=m.u.find(function(a){return a.name===e}))||(k=Ea(a,{name:e,project:m.index}));m=K(k);h={milestone:k.index,report:a.a.index,comment:b,status:Ka(l),date:(new Date(h+"T00:00:00.000Z")).valueOf()+1};m?m.restore(h):J(a,h)}
function La(a,b){Ia(b);a.o.filter(function(b){return b.w===a.a}).forEach(function(a){return L(a)});for(var c=1;c<b.length;c++)Ja(a,b[c])}f.Za=function(){Ga(this,{name:"New Programme"});this.h()};var Ma="Programme Name;Project Name;Milestone Name;Date (YYYY-MM-DD);Health ('complete', 'on-track', 'at-risk', 'late', or 'previous);Comment".split(";").map(function(a){return JSON.stringify(a)}).join(",");
function Na(a){a=a.u.filter(function(a){return K(a)}).map(function(a){return Oa(a)}).join("\n");return Ma+"\n"+a}f=u.prototype;f.sa=function(a,b){this.name=b.text};f.Xa=function(a,b){b.m<=this.j&&(this.start=b.m);this.h()};f.Wa=function(a,b){b.m>=this.start&&(this.j=b.m);this.h()};f.Ua=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.a=this.b[a]);this.h()};f.Ta=function(a){a=a.currentTarget.value;0<=a&&a<this.b.length&&(this.g=this.b[a]);this.h()};function C(a,b,c){this.c=B("g",{"class":"dateHeader"},b);this.g=B("g",{},this.c);this.j=B("g",{},this.c);this.G=B("g",{"class":"dateHeader"},c);this.a=a;this.h()}function Pa(a){a.setUTCHours(0,0,0,0);return a}function Qa(a){a.setUTCMonth(0,1);a.setUTCHours(0,0,0,0);return a}function Ra(a){a.setUTCDate(1);a.setUTCHours(0,0,0,0);return a}function Sa(a){a.setUTCDate(a.getUTCDate()-(a.getUTCDay()-1)%7);return a}function Ta(a){var b=a.getUTCFullYear();a.setUTCFullYear(b-b%10);Qa(a);return a}
function Ua(a){a.setUTCDate(a.getUTCDate()+1);return a}function Va(a){a.setUTCDate(a.getUTCDate()+7);return a}function Wa(a){a.setUTCMonth(a.getUTCMonth()+1);return a}function Xa(a){a.setUTCFullYear(a.getUTCFullYear()+1);return a}function Ya(a){a.setUTCFullYear(a.getUTCFullYear()+10);return a}function Za(a){return a.getUTCDate()}
function $a(a){var b=3-(a.getUTCDay()-1)%7,c=new Date(a.valueOf());Pa(c);c.setUTCDate(a.getUTCDate()+b);return""+Math.ceil((c.valueOf()-(new Date(c.getUTCFullYear(),0,1)).valueOf())/6048E5)}function ab(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]}function bb(a){return""+a.getUTCFullYear()}function cb(a){a=a.getUTCFullYear();return""+(a-a%10)+"'s"}
C.prototype.h=function(){this.g.innerHTML="";var a=B("g",{transform:"translate("+(N+60)+" 0)"},this.j);this.b=new O(this.a.width-2*N-120,a);new P(this.a.name,{l:this.a.l,F:"Untitled",onchange:this.a.sa.bind(this.a)},{"class":"mMapTitle"},this.b.a);this.b.b();this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.b.c.addEventListener("verticalResize",this.J.bind(this));this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+this.b.height+
")");a=B("g",{},this.j);new Q({l:this.a.l,onchange:this.a.Xa.bind(this.a),parent:a,max:this.a.j-1728E5,Z:R,D:{transform:"translate(10 -5)","class":"mMapEdgeDate"}},this.a.start);a=B("g",{},this.j);new Q({l:this.a.l,onchange:this.a.Wa.bind(this.a),parent:a,min:this.a.start+1728E5,Z:S,D:{transform:"translate("+(this.a.width-10)+" -5)","class":"mMapEdgeDate"}},this.a.j);db(this.a.a,{transform:"translate("+(this.a.width-N)+", -5)"},this.j);this.a.a!==this.a.g&&db(this.a.g,{transform:"translate("+N+", -5)"},
this.j);a=[];var b=this.a.j-this.a.start,c=b/this.a.width;189216E6<b&&a.push(eb);18144E6<b&&a.push(fb);1728E6<b&&8928E4>c&&a.push(gb);3024E4>c&&a.push(hb);432E4>c&&a.push(ib);b=20;for(c=0;c<a.length-2;c++)T(this,b,20,a[c],this.B.bind(this)),b+=20;1<a.length?(T(this,b,"100%",a[a.length-2],this.B.bind(this)),T(this,b,"100%",a[a.length-2],this.C.bind(this)),b+=20,T(this,b,20,a[a.length-1],this.M.bind(this))):(T(this,b,"100%",a[0],this.B.bind(this)),T(this,b,"100%",a[0],this.C.bind(this)));this.O=this.o=
b+20;this.o+=10+this.b.height;B("rect",{x:0,y:0,width:H(this.a),height:"100%","class":"whiteBackground"},this.g);B("rect",{x:0,y:0,width:H(this.a),height:"100%","class":"whiteBackground"},this.G)};C.prototype.C=function(a,b,c,d,e,h){B("rect",{"class":h,height:"100%",y:"0",x:a,width:b-a},this.G)};C.prototype.B=function(a,b,c,d,e,h){B("rect",{"class":h,height:d,y:c,x:a,width:b-a},this.g);B("text",{"class":"majorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};
C.prototype.M=function(a,b,c,d,e){B("line",{"class":"dateHeaderSeparator",x1:a,y1:c+3,x2:a,y2:c+d-3},this.g);B("text",{"class":"minorRowText",y:c+15,x:(a+b)/2,"text-anchor":"middle"},this.g).textContent=e};var ib=0,hb=1,gb=2,fb=3,eb=4;
function T(a,b,c,d,e){switch(d){case ib:var h=Pa,l=Ua,k=Za;break;case hb:h=Sa;l=Va;k=$a;break;case gb:h=Ra;l=Wa;k=ab;break;case fb:h=Qa;l=Xa;k=bb;break;case eb:h=Ta,l=Ya,k=cb}d=h(new Date(a.a.start));for(h=0;d.valueOf()<=a.a.j;){var m=k(d),p=I(a.a,d),M=I(a.a,l(d));e(p,M,b,c,m,0===h%2?"even":"odd");h++}}C.prototype.J=function(){this.j.setAttribute("transform","translate(0 "+this.b.height+")");this.g.setAttribute("transform","translate(0 "+this.b.height+")");this.o=this.O+10+this.b.height;D(this.a)};
var N=250;function x(a,b,c){this.c=B("g",{"class":"milestone"});this.b=c;this.index=b;this.g=[];this.restore(a)}x.prototype.restore=function(a){var b=this;t(function(){return Number.isInteger(a.project)});t(function(){return b.b.i[a.project]||0>a.project});this.name=a.name;this.a&&this.a.X(this);0<=a.project?this.a=this.b.i[a.project]:this.a=this.b.G;this.a.da(this)};
function Oa(a){var b=K(a),c=b?A(b.m):null;return[-1===a.a.index?a.a.name:a.a.a.name,a.a.name,a.name,c,jb(b),b.A].map(function(a){return JSON.stringify(a)}).join(",")}
x.prototype.h=function(){this.c.innerHTML="";var a=K(this),b=this.j&&this.j.w===this.b.g?this.j:this.j=U(this,this.b.g);if(a&&b&&this.b.a!==this.b.g){var c=b.x,d=a.x;var e=kb(-45,45,.1*(c-d));var h=4*e;B("path",{"class":"thick evenDashed brightPink noFill",d:"M"+c+" 0 C"+(c-h)+" "+(0+e)+" "+(d+h)+" "+(0+e)+" "+d+" 0"},this.c)}b&&this.c.appendChild(b.c);a&&this.c.appendChild(a.c)};function lb(a,b){b.w===a.b.a&&(a.o=null);b.w===a.b.g&&(a.j=null);a.g=a.g.filter(function(a){return a!==b})}
function mb(a){a.a.X(a);a.g.forEach(function(a){return L(a)});V(a.b.u,a)}function U(a,b){return a.g.find(function(a){return a.w===b})}function K(a){return a.o&&a.o.w===a.b.a?a.o:a.o=U(a,a.b.a)};function w(a,b,c){this.c=B("g",{"class":"project"},c.v[a.programme].c);this.b=c;this.height=0;this.u=[];this.index=b;this.o=this.B=this.K=0;this.restore(a)}f=w.prototype;f.restore=function(a){var b=this;t(function(){return"string"===typeof a.name});t(function(){return!a.comment||"string"===typeof a.comment});t(function(){return Number.isInteger(a.programme)});t(function(){return b.b.v[a.programme]});this.name=a.name;this.A=a.comment||"";this.a&&nb(this.a,this);this.a=this.b.v[a.programme];this.a.i.push(this)};
f.h=function(){var a=this;this.c.innerHTML="";this.j=B("g",{},this.c);B("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},this.j);var b=this.ha();this.u.forEach(function(b){return a.j.appendChild(b.c)});this.j.appendChild(b);b=B("g",{transform:"translate(20 0)"},this.j);this.g=new O(H(this.b)-20,b);new P(this.name,{l:this.b.l,F:"Untitled",onchange:this.Ga.bind(this)},{"class":"projectHeader"},this.g.a);new P(this.A,{l:this.b.l,F:"...",onchange:this.Fa.bind(this)},{"class":"headingComment"},
this.g.a);this.g.b();this.g.c.addEventListener("verticalResize",this.Da.bind(this));ob(this);this.j.setAttribute("transform","translate(0 "+(this.height-20)+")");this.C=W(R,this.b.l,[{icon:"icons/move-down.svg",action:this.Ha.bind(this)},{icon:"icons/move-up.svg",action:this.Ia.bind(this)},{icon:"icons/delete.svg",action:this.Ea.bind(this)},{icon:"icons/plus.svg",action:this.ia.bind(this)}],{transform:"translate(0 "+(-20-this.g.height)+")"},b);return this.c};
f.ha=function(){var a=[],b=[],c=this.u.map(function(a){return K(a)}).filter(function(a){return a&&F(a)});c.sort(function(a,b){return b.x-a.x});c.forEach(function(c){var d=c.x,e=pb("small sans-serif",c.s.name+"MMM 00: ")+15;e=d+e;var k=pb("small italic sans-serif",c.A);k=0===k?0:k+15;for(var m=d+k,p=0;p<a.length&&(a[p]&&!(m<=a[p])||a[p+1]&&!(e<=a[p+1]));p++);a[p+1]=d;0!==k&&(a[p]=d);b[p]||(b[p]=B("g",{transform:"translate(0, "+-p*qb/2+")"}));b[p].appendChild(c.$);c.P.innerHTML="";d=20-qb/2*p-40-20;
B("line",{x1:"0",y1:d,x2:"0",y2:0},c.P);B("circle",{cx:"0",cy:d,r:"2"},c.P)});this.o=b.length*qb/2;c=B("g",{transform:"translate(0 -20)"});for(var d=b.length-1;0<=d;d--)b[d]&&c.appendChild(b[d]);this.o+=40;return c};f.Da=function(){var a=this.height;ob(this);this.C&&this.C.setAttribute("transform","translate(0 "+(-20-this.g.height)+")");a!==this.height&&(this.j.setAttribute("transform","translate(0 "+(this.height-20)+")"),this.L())};function ob(a){var b=a.g.height+15,c=a.o;a.height=b>c?b:c}
f.L=function(){var a=this.a;a.height=G(45,a.i);D(this.b)};f.da=function(a){this.u.push(a)};f.X=function(a){this.u=this.u.filter(function(b){return b!==a})};f.Ga=function(a,b){this.name=b.text};f.Fa=function(a,b){this.A=b.text};function rb(a){nb(a.a,a);a.u.forEach(function(a){return mb(a)});V(a.b.i,a)}f.Ea=function(){rb(this);this.L()};
f.ia=function(){var a=Ea(this.b,{name:"New Milestone",project:this.index});J(this.b,{milestone:a.index,report:this.b.a.index,comment:"",status:sb,date:Ba()}).h();a.h();this.h();this.L()};
f.Ia=function(){var a=this.a.i.indexOf(this);if(0===a){a=this.a;var b=this.a.index;0>=b||(this.a.i.shift(),V(this.b.i,this),b--,this.a=this.b.v[b],b=this.a.i[this.a.i.length-1],this.a.i.push(this),b?tb(this.b.i,this,b.index+1):(b=this.b.i,this.index=b.length,b.push(this)));a.h();this.a.h();D(this.b)}else a=this.a.i[a-1],ub(this.b.i,a.index,this.index),vb(this.a.i,this,a),this.L()};
f.Ha=function(){var a=this.a.i.indexOf(this);if(a===this.a.i.length-1){a=this.a;var b=this.a.index;b>=this.b.v.length-1||(this.a.i.pop(),V(this.b.i,this),b++,this.a=this.b.v[b],b=this.a.i[0],this.a.i.unshift(this),b?tb(this.b.i,this,b.index):(b=this.b.i,this.index=b.length,b.push(this)));a.h();this.a.h();D(this.b)}else a=this.a.i[a+1],ub(this.b.i,a.index,this.index),vb(this.a.i,this,a),this.L()};function oa(a,b,c){this.c=B("g",{"class":"programme"});this.a=c;this.index=b;this.height=45;this.i=[];this.K=0;this.restore(a)}f=oa.prototype;f.restore=function(a){t(function(){return"string"===typeof a.name});t(function(){return!a.comment||"string"===typeof a.comment});this.name=a.name;this.A=a.comment||""};
f.h=function(){var a=this;this.c.innerHTML="";var b=B("g",{transform:"translate(0 40)"},this.c);wb(this,b);W(S,this.a.l,[{icon:"icons/move-down.svg",action:this.Ba.bind(this)},{icon:"icons/move-up.svg",action:this.Ca.bind(this)},{icon:"icons/delete.svg",action:this.ya.bind(this)},{icon:"icons/plus.svg",action:this.$a.bind(this)}],{transform:"translate("+this.a.width+" -30)"},b);this.i.forEach(function(b){return a.c.appendChild(b.c)});this.height=G(45,this.i);return this.c};
function wb(a,b){a.b=new O(a.a.width-250,b);new P(a.name,{l:a.a.l,F:"Untitled",onchange:a.Aa.bind(a)},{"class":"programmeHeader"},a.b.a);new P(a.A,{l:a.a.l,F:"...",onchange:a.za.bind(a)},{"class":"headingComment"},a.b.a);a.b.b()}
function wa(a,b,c,d,e){var h=c,l=B("g",{"class":"programme"}),k=B("g",{transform:"translate(0 40)"},l);wb(a,k);k=45;for(var m=[];c<a.i.length&&k<b;c++){var p=a.i[c];p.B=e;p.c.setAttribute("transform","translate(0, "+k+")");p.K=k+a.K;m.push(p);k+=p.height}if(k<b)return m.forEach(function(a){return l.appendChild(a.c)}),{c:l,T:b-k,index:a.i.length};if(0===m.length&&d)throw Error("Not enough room on page for programme headers.");if(1===m.length&&d)throw Error("Project: '"+m[0].name+"' is larger than a single page, and cannot be printed");
if(1>=m.length)return{c:B("g",{}),T:0,index:h};m.pop();m.forEach(function(a){return l.appendChild(a.c)});return{c:l,T:0,index:c-1}}function nb(a,b){a.i=a.i.filter(function(a){return a!==b})}f.Aa=function(a,b){this.name=b.text};f.za=function(a,b){this.A=b.text};function xb(a){a.i.forEach(function(a){return rb(a)});V(a.a.v,a)}f.$a=function(){Fa(this.a,{name:"New Project",programme:this.index}).h();this.h();D(this.a)};
f.Ca=function(){var a=this.a.v.indexOf(this);0!==a&&(ub(this.a.v,this.a.v[a-1].index,this.index),D(this.a))};f.Ba=function(){var a=this.a.v.indexOf(this);a!==this.a.v.length-1&&(ub(this.a.v,this.a.v[a+1].index,this.index),D(this.a))};f.ya=function(){xb(this);this.a.h()};function pa(a,b,c){this.c=B("g",{"class":"msAtReport"});this.g=B("g",{"class":"businessMsLine"});this.aa=B("g",{"class":"businessMsLine"});this.$=B("g",{"class":"milestoneInfo"});this.P=B("g",{"class":"milestonePointer"});this.b=[];this.S=[];this.index=b;this.a=c;this.restore(a)}var sb=1;f=pa.prototype;
f.restore=function(a){var b=this;t(function(){return Number.isInteger(a.milestone)});t(function(){return b.a.u[a.milestone]});t(function(){return Number.isInteger(a.report)});t(function(){return b.a.b[a.report]});t(function(){return"string"===typeof a.comment});t(function(){return Number.isInteger(a.date)});t(function(){return Number.isInteger(a.status)});t(function(){return 0<=a.status&&4>=a.status});this.s&&lb(this.s,this);this.s=this.a.u[a.milestone];this.s.g.push(this);this.w=this.a.b[a.report];
this.A=a.comment;this.status=a.status;this.m=Ca(a.date)};function ra(a){return{milestone:a.s.index,report:a.w.index,comment:a.A,status:a.status,date:a.m}}
f.h=function(){this.c.innerHTML="";this.P.innerHTML="";this.x=I(this.a,this.m);this.c.setAttribute("transform","translate("+this.x+" 0)");if(F(this)){this.$.innerHTML="";if(this.a.a===this.w){var a=B("g",{transform:"translate("+this.x+" 0)"},this.$);new yb({l:this.a.l,ba:this.Va.bind(this),parent:a,D:{"class":"milestoneData"}},this.s.name,this.m,this.A);W(R,this.a.l,[{icon:"icons/health.svg",action:this.Ma.bind(this)},{icon:"icons/delete.svg",action:this.xa.bind(this)},{icon:"icons/arrow-right.svg",
action:this.La.bind(this)}],{transform:"translate(0, -75)"},a)}this.c.appendChild(this.P);this.a.a===this.w&&-1===this.s.a.index&&F(this)&&this.c.appendChild(this.g);a=B("g",{},this.c);this.j=B("path",{"class":jb(this),d:"M -7 0L 0 7L 7 0L 0 -7 Z"},a);this.j.addEventListener("click",this.Pa.bind(this))}};f.I=function(){this.g.innerHTML="";this.aa.innerHTML="";B("line",{x1:0,y1:0,x2:0,y2:"100%"},this.g);B("line",{x1:this.x,y1:0,x2:this.x,y2:"100%"},this.aa);return this.g};
function jb(a){if(a.a.a===a.w)switch(a.status){case 0:return"complete";case sb:return"on-track";case 2:return"at-risk";case 3:return"late"}else if(a.a.g===a.w)return"previous"}function Ka(a){switch(a){case "complete":return 0;case "on-track":return sb;case "at-risk":return 2;case "late":return 3;case "previous":return 4}}function F(a){return(a.a.a===a.w||a.w===a.a.g)&&Da(a.a,a.m)}function zb(a){var b=a.s.a;return{x:a.x,y:b.a.K+b.K+b.height-20}}
function xa(a){var b=a.s.a;return{x:a.x,y:b.K+b.height-20}}function Ab(a){a=a.s.a;a.h();a.L()}f.R=function(a){this.b.push(a)};function Bb(a,b){a.b=a.b.filter(function(a){return a!==b})}function Cb(a,b){a.S=a.S.filter(function(a){return a!==b})}
f.Pa=function(){1===this.a.V?-1===this.s.a.index||this.w===this.a.g||this.a.R({report:this.a.a.index,dependency:this.a.ca,dependent:this.s.index}).h():this.w!==this.a.g||K(this.s)||(J(this.a,{milestone:this.s.index,report:this.a.a.index,comment:this.A,status:this.status,date:this.m}).h(),this.s.h(),Ab(this))};function L(a){lb(a.s,a);a.b.forEach(function(a){return a.j()});a.S.forEach(function(a){return a.j()});V(a.a.o,a)}
f.Va=function(a){var b=this.a;this.m=kb(b.start,b.j,a.m);this.A=a.A;this.s.name=a.title;this.h();this.I();this.s.h();Ab(this)};f.Ma=function(){this.status=3<=this.status?0:this.status+1;this.j.setAttribute("class",jb(this))};f.xa=function(){L(this);0===this.s.g.length?mb(this.s):this.s.h();Ab(this)};f.La=function(){-1!==this.s.a.index&&(this.a.V=1,this.a.ca=this.s.index,this.a.W=!0)};function y(a,b,c){this.b=B("g",{"class":"reportLine"});this.j=B("g",{"class":"reportLine"});this.index=b;this.a=c;this.restore(a)}y.prototype.restore=function(a){this.m=a.date;this.name=a.name};
function db(a,b,c){a.g=B("g",b,c);b=a===a.a.a?"Current:":"Baseline:";B("text",{"class":"reportHeader","text-anchor":"end"},a.g).textContent=b;b=B("g",{},a.g);new Q({l:a.a.l,onchange:a.o.bind(a),parent:b,Z:S,D:{transform:"translate(0, 20)","class":"reportDate"}},a.m);b=B("g",{},a.g);new Db(a.name,a.a.l,a.B.bind(a),b)}
y.prototype.I=function(){this.b.innerHTML="";this.j.innerHTML="";if(!Da(this.a,this.m))return this.b;var a=I(this.a,this.m);B("line",{x1:a,y1:this.a.O.b.height+20,x2:a,y2:"100%"},this.b);B("line",{x1:a,y1:0,x2:a,y2:"100%"},this.j);return this.b};function Eb(a){a.a.o.filter(function(b){return b.w===a}).forEach(function(a){return L(a)});V(a.a.b,a);a.a.a=a.a.g}y.prototype.o=function(a,b){this.m=b.m;ta(this.a);this.I()};y.prototype.B=function(a,b){this.name=b.text;ta(this.a)};function z(a,b,c){this.c=B("g",{"class":"dependency"});this.c.addEventListener("dblclick",this.j.bind(this));this.index=b;this.g=c;this.restore(a)}
z.prototype.restore=function(a){var b=this;t(function(){return Number.isInteger(a.report)});t(function(){return b.g.b[a.report]});t(function(){return Number.isInteger(a.dependent)});t(function(){return b.g.u[a.dependent]});t(function(){return Number.isInteger(a.dependency)});t(function(){return b.g.u[a.dependency]});this.w=this.g.b[a.report];this.b&&Bb(this.b,this);this.b=U(this.g.u[a.dependent],this.w);t(function(){return b.b});this.b.R(this);this.a&&Cb(this.a,this);this.a=U(this.g.u[a.dependency],
this.w);t(function(){return b.a});this.a.S.push(this)};function sa(a){return{dependent:a.b.s.index,dependency:a.a.s.index,report:a.w.index}}z.prototype.h=function(){this.c.innerHTML="";this.w===this.g.a&&F(this.b)&&F(this.a)&&ya(zb(this.a),zb(this.b),this.c)};
function ya(a,b,c){if(a.x<=b.x)var d="dependencyLineOK",e="dependencyArrowOK";else d="dependencyLineLate",e="dependencyArrowLate";b.x-=7;Fb(a,b,d,c);Fb(a,b,"vthick transparentLine",c);B("path",{"class":e,d:"M -4 -4 L -4 4 L 0 0 Z",transform:"translate("+b.x+", "+b.y+")"},c)}var Gb=0;
function za(a,b,c,d){ya(b,c,d);c=Fb(b,c,"transparentLine",d);Gb++;b="dependency"+Gb;c.setAttribute("id",b);c=B("text",{"class":"dependencyText"},d);B("textPath",{"xlink:href":"#"+b},c).textContent="\u00a0\u00a0\u00a0\u00a0"+a.b.s.name;d=B("text",{"text-anchor":"end","class":"dependencyText"},d);B("textPath",{"xlink:href":"#"+b,startOffset:"100%"},d).textContent=a.a.s.name+"\u00a0\u00a0\u00a0\u00a0"}z.prototype.j=function(){Cb(this.a,this);Bb(this.b,this);V(this.g.C,this);this.c.parentNode.removeChild(this.c)};function na(a){this.u=[];this.index=-1;this.name="Business Milestones";this.c=B("g",{"class":"businessMs"});this.g=B("g",{"class":"businessMs"});this.b=a;this.height=40;this.o=0}f=na.prototype;
f.h=function(){var a=this;this.c.innerHTML="";this.g.innerHTML="";var b=this.ka();this.height=this.o;var c=B("g",{transform:"translate(0 "+(this.height-20)+")"},this.c);B("line",{x1:0,y1:0,x2:this.b.width,y2:0,"class":"projectLine"},c);this.u.filter(function(a){return K(a)}).forEach(function(b){var d=K(b);d.I();c.appendChild(b.c);a.g.appendChild(d.aa)});c.appendChild(b);b=B("g",{"class":"businessMsHeader",transform:"translate(0, -10)"},c);B("text",{},b).textContent="Business Milestones";W(R,this.b.l,
[{icon:"icons/plus.svg",action:this.la.bind(this)}],{transform:"translate(180, -7)"},b);return this.c};f.ka=w.prototype.ha;f.L=function(){D(this.b)};f.da=function(a){this.u.push(a)};f.X=function(a){this.u=this.u.filter(function(b){return b!==a})};f.la=w.prototype.ia;function yb(a,b,c,d){this.l=a.l;this.ba=a.ba||function(){};this.parent=a.parent;this.D=a.D||{};this.a=!1;this.restore(b,c,d);this.h()}var qb=35;f=yb.prototype;f.restore=function(a,b,c){this.title=a;this.title=""===this.title?"Untitled":this.title;this.m=b;this.A=c;this.A=""===this.A?"":this.A};f.h=function(){this.c=Hb(this.wa.bind(this),this.va.bind(this),this.l,this.D,this.parent)};
f.va=function(a){a.innerHTML="";a=B("foreignObject",{width:315,height:45,x:5,y:-55},a);var b=X("input",{"class":"svgDateBox",value:A(this.m),type:"date",required:""},a);b.addEventListener("change",this.ua.bind(this,b));b=X("input",{"class":"svgTextBox",value:this.title,type:"text",placeholder:"Milestone Name"},a);b.addEventListener("change",this.Ya.bind(this,b));a=X("input",{"class":"svgCommentBox",value:this.A,type:"text",placeholder:"Milestone Comment"},a);a.addEventListener("change",this.ta.bind(this,
a))};f.wa=function(a){this.a&&(this.ba(this),this.a=!1);a.innerHTML="";var b=new Date(this.m);b=ab(b)+" "+Za(b)+": ";B("text",{"text-anchor":"start",transform:"translate(5, -15)"},a).textContent=Ib(b+this.title,100);B("text",{"class":"msComment",transform:"translate(5, 0)"},a).textContent=Ib(this.A,100)};f.Ya=function(a){this.restore(a.value,this.m,this.A);this.a=!0};f.ta=function(a){this.restore(this.title,this.m,a.value);this.a=!0};f.ua=function(a){this.m=Jb(a);this.a=!0};function g(){var a=document.getElementById("app");this.c=X("div",{"class":"milestoneMapContainer"},a);this.parent=a;Kb(this.h.bind(this));this.ja()}g.prototype.a=function(){var a=JSON.stringify(qa(this.map),null,"\t");Lb(this.map.name+".json",a,"application/json",this.c)};g.prototype.restore=function(a){a=JSON.parse(a);this.map=new u(a)};
g.prototype.h=function(){this.c.innerHTML="";var a=X("div",{"class":"menubar"},this.c),b=Y("File",a);Z([{icon:"icons/new.svg",action:this.ja.bind(this)},{icon:"icons/open.svg",action:this.Sa.bind(this)},{icon:"icons/save.svg",action:this.a.bind(this)},{icon:"icons/exportCSV.svg",action:this.Qa.bind(this)},{icon:"icons/import.svg",action:this.Ra.bind(this)}],b.body);b=Y("Programme",a);Z([{icon:"icons/plus.svg",action:this.map.Za.bind(this.map)}],b.body);b=Y("Comparison",a);Z([{icon:"icons/camera.svg",
action:this.ab.bind(this)},{icon:"icons/delete.svg",action:this.Oa.bind(this)}],b.body);ta(this.map);b.body.appendChild(this.map.fa);b=Y("Print",a);Z([{icon:"icons/print.svg",action:this.ra.bind(this)}],b.body);Mb(this,b.body);b=Y("About",a);Z([{icon:"icons/info.svg",action:function(){return alert('Milestone Map, Version: 1.2.6\u03b2\n\nFor help and support, please visit:\n\nhttps://andymac-2.github.io/milestoneMap/instructions\n\n\n\nCopyright 2018 Andrew Pritchard\n\nLicensed under the Apache License, Version 2.0 (the "License");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n')}},
{icon:"icons/question.svg",action:function(){return window.open("https://andymac-2.github.io/milestoneMap/instructions")}}],b.body);this.map.qa=window.innerHeight-a.getBoundingClientRect().height-5;this.c.appendChild(this.map.J);this.map.h()};
var Nb=[{height:1682,width:2378},{height:1189,width:1682},{height:841,width:1189},{height:594,width:841},{height:420,width:594},{height:297,width:420},{height:210,width:297},{width:1682,height:2378},{width:1189,height:1682},{width:841,height:1189},{width:594,height:841},{width:420,height:594},{width:297,height:420},{width:210,height:297}].map(function(a){return a.width>a.height?{height:a.height-70,width:a.width-70}:a}),ma=Nb[5],Ob="4A0 Landscape;2A0 Landscape;A0 Landscape;A1 Landscape;A2 Landscape;A3 Landscape;A4 Landscape;4A0 Portrait;2A0 Portrait;A0 Portrait;A1 Portrait;A2 Portrait;A3 Portrait;A4 Portrait".split(";");
function Mb(a,b){ua("Page Size:",function(b){a.map.B=Nb[b.currentTarget.value]},Ob,{"class":"pageSizeSelector"},b)}f=g.prototype;f.ab=function(){Ha(this.map);this.h()};f.Oa=function(){1>=this.map.b.length||(Eb(this.map.a),this.h())};
f.ja=function(){var a=Ba(),b=a-5184E6,c=new Date(b);c=c.setUTCFullYear(c.getUTCFullYear()+1).valueOf();this.map=new u({name:"New Map",start:b,end:c,programmes:[],projects:[],milestones:[],msAtReports:[],reports:[{name:"Baseline",date:a}],dependencies:[],currReport:0,cmpReport:0});this.h()};f.Sa=function(){var a=this;Pb(this.c,function(b){try{a.restore(b),a.h()}catch(c){throw alert("Error: Invalid file."),c;}},".json")};
f.Ra=function(){var a=this;Pb(this.c,function(b){try{var c=[],d=!1,e,h,l;for(l=h=e=0;e<b.length;e++){var k=b[e],m=b[e+1];c[l]=c[l]||[];c[l][h]=c[l][h]||"";'"'==k&&d&&'"'==m?(c[l][h]+=k,++e):'"'==k?d=!d:","!=k||d?"\r"!=k||"\n"!=m||d?"\n"!=k||d?"\r"!=k||d?c[l][h]+=k:(++l,h=0):(++l,h=0):(++l,h=0,++e):++h}0===c[c.length-1].length&&c.pop();La(a.map,c);a.h()}catch(p){throw alert(p.name+": "+p.message),p;}},".csv")};f.Qa=function(){var a=Na(this.map);Lb(this.map.name+".csv",a,"text/csv",this.c)};
f.ra=function(){var a=new u(qa(this.map),this.map.B);try{va(a),this.parent.innerHTML=a.Y.innerHTML,window.print(),this.parent.innerHTML="",this.parent.appendChild(this.c)}catch(b){throw alert(b.name+": "+b.message),b;}};var R=1,S=2;function Fb(a,b,c,d){return B("path",{"class":c,d:"M"+a.x+" "+a.y+" C"+(a.x+150)+" "+a.y+" "+(b.x-150)+" "+b.y+" "+b.x+" "+b.y},d)};function G(a,b){b.forEach(function(b){b.c.setAttribute("transform","translate(0, "+a+")");b.K=a;a+=b.height});return a}function Qb(a){a=a.getCTM();return{x:a.e,y:a.f}}var Rb=void 0;function Hb(a,b,c,d,e){d=B("g",d,e);return Sb(d,a,b,c,e)}function Sb(a,b,c,d,e){function h(){b(a);e.contains(a)&&e.addEventListener("click",l)}function l(){c(a);e.removeEventListener("click",l);e.contains(a)&&d.H.push({c:e,event:h})}h();return a}function pb(a,b){Tb.font=a;return Tb.measureText(b).width}var Tb=document.createElement("canvas").getContext("2d");function Ub(a,b,c){c=B("g",{"class":"menu"},c);switch(a){case 0:var d=45*(b.length+1)/-2;break;case R:d=-22.5;break;case S:d=-(45*(b.length+1))}for(a=0;a<b.length;a++){d+=45;var e=B("g",{transform:"translate("+d+", 0)","class":"menuEntry"},c);e.addEventListener("click",b[a].action);B("circle",{"class":"iconCircle",r:"14"},e);B("image",{x:"-8",y:"-8",height:"16",width:"16"},e).setAttributeNS("http://www.w3.org/1999/xlink","href",b[a].icon)}return c}
function W(a,b,c,d,e){return Hb(function(a){return a.innerHTML=""},function(b){b.innerHTML="";Ub(a,c,b)},b,d,e)}function Y(a,b){b=v("span",{"class":"menuBarSegment"},b);v("div",{"class":"menuBarHeader"},b).textContent=a;a=v("div",{"class":"menuBarContent"},b);return{c:b,body:a}}function Z(a,b){b=v("span",{},b);b=B("svg",{width:45*a.length,height:40},b);Ub(R,a,b).setAttribute("transform","translate (0, 20)")}
function ua(a,b,c,d,e){d=v("span",d,e);v("div",{"class":"dropdownSegmentHeading"},d).textContent=a;a=v("select",{"class":"dropdownSegmentDropdown"},d);a.addEventListener("change",b);v("option",{selected:"",disabled:"",hidden:""},a).textContent="Please choose:";for(b=0;b<c.length;b++)v("option",{value:b},a).textContent=c[b]};function O(a,b){this.width=a;this.height=0;this.c=B("g",{},b);this.g=B("foreignObject",{width:this.width},this.c);this.a=v("div",{style:"width:"+this.width+"px;max-width:"+this.width+"px;"},this.g);this.a.addEventListener("input",this.b.bind(this))}
O.prototype.b=function(){var a=this.a;document.contains(a)?a=a.offsetHeight:(Rb||(Rb=v("div",{style:"position:absolute;visibility:hidden;"},document.body)),a=a.cloneNode(!0),Rb.appendChild(a),a=a.offsetHeight,Rb.innerHTML="");a+=8;this.height!==a&&(this.height=a,this.g.setAttribute("height",this.height),this.g.setAttribute("y",-this.height),a=new CustomEvent("verticalResize",{detail:this}),this.c.dispatchEvent(a))};
function P(a,b,c,d){var e=this;this.l=b.l;this.F=b.F;this.parent=d;this.onchange=b.onchange||function(){};c.contenteditable="true";this.c=v("p",c,d);this.c.addEventListener("input",this.ma.bind(this,this.c));this.c.addEventListener("input",function(a){return e.onchange(a,e)});this.c.addEventListener("focus",this.bb.bind(this));this.restore(a);this.h()}f=P.prototype;f.restore=function(a){this.text=a?a:this.F};f.h=function(){Sb(this.c,this.cb.bind(this),this.Ka.bind(this),this.l,this.parent)};
f.cb=function(){this.c.textContent=this.text||this.F;this.c.classList.remove("clickedActive");this.c.classList.add("notClickedActive")};f.Ka=function(){this.c.textContent=this.text;this.c.classList.add("clickedActive");this.c.classList.remove("notClickedActive")};f.bb=function(){var a=this.c,b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();a.addRange(b)};f.ma=function(a){this.restore(a.textContent)};function v(a,b,c){a=document.createElement(a);if(b)for(var d in b)a.setAttribute(d,b[d]);c&&c.appendChild(a);return a}function Vb(a,b,c,d){a=document.createElementNS(a,b);if(c)for(var e in c)a.setAttribute(e,c[e]);d&&d.appendChild(a);return a}var B=Vb.bind(null,"http://www.w3.org/2000/svg"),X=Vb.bind(null,"http://www.w3.org/1999/xhtml");function Db(a,b,c,d){var e=R;this.F="Untitled";switch(e){case R:this.a="start";break;case 0:this.a="middle"}this.l=b;this.onchange=c;this.parent=d;this.D={transform:"translate(5, 20)","class":"reportName"};this.restore(a);this.h()}f=Db.prototype;f.restore=function(a){this.text=a;this.text=""===this.text?this.F:this.text};f.h=function(){this.c=Hb(this.pa.bind(this),this.oa.bind(this),this.l,this.D,this.parent)};
f.oa=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c,e="middle"===this.a?d/-2:0,h=Qb(a),l=-h.x;h=-h.y;a=B("foreignObject",{width:d,height:1.4*c,transform:"translate("+l+", "+h+")",x:e-l,y:0-c-h},a);a=v("input",{"class":"svgTextBox",type:"text",value:this.text},a);a.focus();a.select();a.addEventListener("change",this.na.bind(this,a));a.addEventListener("change",function(a){return b.onchange(a,b)})};
f.pa=function(a){a.innerHTML="";B("text",{"text-anchor":this.a},a).textContent=Ib(this.text,40)};f.na=function(a){this.restore(a.value)};function Q(a,b){switch(a.Z){case R:this.a="start";break;case S:this.a="end"}this.l=a.l;this.onchange=a.onchange||function(){};this.parent=a.parent;this.D=a.D||{};this.min=a.min||null;this.max=a.max||null;this.restore(b);this.h()}Q.prototype.restore=function(a){this.m=a};Q.prototype.h=function(){this.c=Hb(this.g.bind(this),this.b.bind(this),this.l,this.D,this.parent)};
Q.prototype.b=function(a){var b=this,c=a.getBoundingClientRect().height;a.innerHTML="";var d=10*c;a=B("foreignObject",{width:d,height:1.5*c,x:"start"===this.a?0:-d,y:0-c},a);c={"class":"svgDateBox",value:A(this.m),type:"date",required:""};this.min&&(c.min=A(this.min));this.max&&(c.max=A(this.max));var e=X("input",c,a);e.focus();e.select();e.addEventListener("blur",function(a){""!==e.value&&(b.m=Jb(e));b.onchange(a,b)})};
Q.prototype.g=function(a){a.innerHTML="";B("text",{"text-anchor":this.a},a).textContent=A(this.m)};function la(a){this.c=a;this.H=[];this.a=[];a.addEventListener("click",this.click.bind(this),!0)}la.prototype.click=function(a){for(var b=0;b<this.H.length;b++)for(;this.H[b]&&(!this.c.contains(this.H[b].c)||!this.H[b].c.parentNode.contains(a.target));)this.H[b].event(),this.H[b]=this.H[this.H.length-1],this.H.pop();for(b=0;b<this.a.length;b++)this.a[b].c.parentNode.contains(a.target)||this.a[b].event()};function kb(a,b,c){c=c>b?b:c;return c<a?a:c}function tb(a,b,c){for(var d=a.length;d>c;d--)a[d]=a[d-1],a[d].index=d;a[c]=b;b.index=c}function V(a,b){for(b=b.index;b<a.length-1;b++)a[b]=a[b+1],a[b].index=b;a.pop()}function vb(a,b,c){b=a.indexOf(b);c=a.indexOf(c);var d=a[b];a[b]=a[c];a[c]=d}function ub(a,b,c){var d=a[b];a[b]=a[c];a[c]=d;a[b].index=b;a[c].index=c}function A(a){return(new Date(a)).toISOString().slice(0,10)}function Jb(a){return(new Date(a.value+"T00:00:00.000Z")).valueOf()+1}
function Ca(a){return a-a%864E5+1}function Lb(a,b,c,d){var e=v("a",{style:"display:none;"},d);e.href="download"in e?URL.createObjectURL(new Blob([b],{type:c})):"data:application/octet-stream,"+encodeURIComponent(b);e.download=a;e.click();d.removeChild(e)}
function Pb(a,b,c){var d={type:"file",style:"display:none;"};c&&(d.accept=c);var e=v("input",d,a),h=new FileReader;h.onload=function(){b(h.result);a.contains(e)&&a.removeChild(e)};e.addEventListener("change",function(){h.readAsText(e.files[0])});e.click()}function Ib(a,b){return a.length>b-3?a.slice(0,b-3)+"...":a}function Kb(a){var b=window,c=100;c=c||100;var d;b.addEventListener("resize",function(){d&&window.clearTimeout(d);d=setTimeout(a,c)})};}).call(this);
